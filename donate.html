<!-- donate.html -->
<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ Ø­Ù…Ø§ÛŒØª Ø§Ø² Ù…ÛŒÙ„Ø§Ø¯ Ú©Ø§ØªØ§Ú©ÙˆØ±ÛŒ</title>
<link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;600&display=swap" rel="stylesheet">
<style>
body {
  margin:0;
  font-family:'Vazirmatn',sans-serif;
  background:#000;
  color:#00ff99;
  text-align:center;
  direction:rtl;
  overflow-x:hidden;
}
h1 {
  margin:40px 0 30px;
  font-size:2.2em;
  text-shadow:0 0 15px #00ff99;
}
.button-container {
  display:flex;
  justify-content:center;
  gap:20px;
  flex-wrap:wrap;
  margin-bottom:50px;
}
.btn {
  display:inline-block;
  padding:14px 28px;
  font-size:1.2em;
  color:#00ff99;
  text-decoration:none;
  border:1px solid #00ff99;
  border-radius:10px;
  box-shadow:0 0 15px #00ff99;
  transition:all 0.3s ease;
}
.btn:hover {
  background:#fff;
  color:#000;
  box-shadow:0 0 25px #00ff99;
  transform:scale(1.05);
}

/* ÙØ±Ù… Ø­Ù…Ø§ÛŒØª */
#donate-form {
  background:rgba(0,0,0,0.85);
  border:1px solid #00ff99;
  border-radius:12px;
  padding:25px 30px;
  max-width:400px;
  margin:0 auto 40px auto;
  text-align:right;
}
#donate-form label {
  display:block;
  margin:12px 0 6px;
  font-size:1em;
}
#donate-form input {
  width:100%;
  padding:8px 10px;
  font-size:1em;
  border-radius:6px;
  border:1px solid #00ff99;
  background:#000;
  color:#00ff99;
}
#donate-form #converted {
  margin-top:6px;
  font-size:0.95em;
  color:#fff;
  text-align:left;
}

/* ÙˆÛŒØ¯ÛŒÙˆ popup */
#overlay {
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:10;
}
#donation-alert {
  position:absolute;
  top:40%;
  left:50%;
  transform:translate(-50%,-50%);
  text-align:center;
  background:rgba(0,0,0,0.9);
  border:1px solid #00ff99;
  border-radius:16px;
  padding:20px 25px;
  display:none;
  z-index:20;
  animation:fadein 0.5s ease;
}
#donation-video {
  width:180px;
  height:180px;
  border-radius:10px;
  margin-bottom:12px;
}
#donor-text {
  font-size:1.2em;
  text-shadow:0 0 12px #00ff99;
}

/* Ø¬Ù…Ø¹ Ú©Ù„ Ùˆ Ø¯Ø±ØµØ¯ Ù‡Ø¯Ù */
#stats {
  position:fixed;
  bottom:8%;
  left:50%;
  transform:translateX(-50%);
  font-size:1.2em;
  background:rgba(0,0,0,0.85);
  border-radius:12px;
  padding:18px 25px;
  color:#00ff99;
  text-shadow:0 0 10px #00ff99;
  z-index:5;
}

/* Ø³Ø§Ø¹Øª */
#clock {
  position:fixed;
  top:15px;
  right:20px;
  font-size:1.2em;
  color:#00ff99;
}

@keyframes fadein {from{opacity:0;}to{opacity:1;}}
@media(max-width:500px){
  .btn{padding:10px 20px;font-size:1em;}
  h1{font-size:1.8em;margin:30px 0;}
  #donation-video{width:140px;height:140px;}
  #stats{padding:12px 18px;font-size:1em;}
}
</style>
</head>
<body>

<h1>ğŸ Ø­Ù…Ø§ÛŒØª Ø§Ø² Ù…ÛŒÙ„Ø§Ø¯ Ú©Ø§ØªØ§Ú©ÙˆØ±ÛŒ</h1>

<!-- ÙØ±Ù… Ø­Ù…Ø§ÛŒØª -->
<div id="donate-form">
  <label for="name">Ù†Ø§Ù… (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)</label>
  <input type="text" id="name" placeholder="Ù†Ø§Ù… Ø´Ù…Ø§">
  
  <label for="phone">Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³ (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)</label>
  <input type="text" id="phone" placeholder="Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³">
  
  <label for="amount">Ù…Ø¨Ù„Øº (ØªÙˆÙ…Ø§Ù†)</label>
  <input type="number" id="amount" placeholder="Ù…Ø«Ù„Ø§Ù‹ 50000">
  <div id="converted">Ù…Ø¨Ù„Øº Ù…Ø¹Ø§Ø¯Ù„: 0 USDT</div>
  
  <a id="nowpay-btn" class="btn" href="https://nowpayments.io/donation?api_key=MP94SK3-2RNMDJ4-PPKQWSS-GHCVMNJ" target="_blank">
    Ø­Ù…Ø§ÛŒØª Ø¨Ø§ NowPayments
  </a>
</div>

<!-- overlay Ùˆ popup -->
<div id="overlay">
  <div id="donation-alert">
    <video id="donation-video" src="donate.mp4" autoplay muted></video>
    <p id="donor-text"></p>
  </div>
  <div id="stats">
    <p>ğŸ’° Ø¬Ù…Ø¹ Ú©Ù„: <span id="total">0</span> ØªÙˆÙ…Ø§Ù†</p>
    <p>ğŸ¯ Ø¯Ø±ØµØ¯ Ù‡Ø¯Ù: <span id="percent">0</span>%</p>
  </div>
</div>

<!-- Ø³Ø§Ø¹Øª -->
<div id="clock"></div>

<script>
// Ø³Ø§Ø¹Øª Ø²Ù†Ø¯Ù‡
function updateClock(){
  const now = new Date();
  const h=('0'+now.getHours()).slice(-2);
  const m=('0'+now.getMinutes()).slice(-2);
  const s=('0'+now.getSeconds()).slice(-2);
  document.getElementById('clock').textContent = `${h}:${m}:${s}`;
}
setInterval(updateClock,1000);
updateClock();

// Ø¬Ù…Ø¹ Ú©Ù„ Ùˆ popup
let total = 0;
const target = 60000000; // Ù‡Ø¯Ù

function showDonation(name, phone, amount){
  total += amount;
  document.getElementById('total').textContent = total.toLocaleString('fa-IR');
  document.getElementById('percent').textContent = Math.min(((total/target)*100).toFixed(1),100);

  const alertBox = document.getElementById('donation-alert');
  const donorText = document.getElementById('donor-text');
  donorText.textContent = `${name || 'Ø­Ø§Ù…ÛŒ Ù†Ø§Ø´Ù†Ø§Ø³'} | ${amount.toLocaleString('fa-IR')} ØªÙˆÙ…Ø§Ù†${phone ? ' | '+phone : ''}`;
  alertBox.style.display='block';
  const videoEl = document.getElementById('donation-video');
  videoEl.currentTime=0;
  videoEl.play();
  setTimeout(()=>{alertBox.style.display='none';},13000);
}

// ØªØ¨Ø¯ÛŒÙ„ ØªÙˆÙ…Ø§Ù† Ø¨Ù‡ USDT (Ù†Ø±Ø® Ù„Ø­Ø¸Ù‡â€ŒØ§ÛŒ Ù†ÙˆØ¨ÛŒØªÚ©Ø³)
async function getUSDTValue(toman){
  try{
    const res = await fetch('https://api.nobitex.ir/v2/orderbook/?symbol=usdtirt');
    const data = await res.json();
    const rate = parseFloat(data.best_ask); // Ù‚ÛŒÙ…Øª ÙØ±ÙˆØ´ Ù„Ø­Ø¸Ù‡â€ŒØ§ÛŒ
    return (toman / rate).toFixed(2);
  } catch(e){console.warn(e); return (toman/45000).toFixed(2);}
}

const amountInput = document.getElementById('amount');
const converted = document.getElementById('converted');

amountInput.addEventListener('input', async ()=>{
  const value = parseFloat(amountInput.value) || 0;
  const usdt = await getUSDTValue(value);
  converted.textContent = `Ù…Ø¨Ù„Øº Ù…Ø¹Ø§Ø¯Ù„: ${usdt} USDT`;
});

// Ø¯Ú©Ù…Ù‡ NowPayments Ù„ÛŒÙ†Ú© Ø¨Ø§ Ù…Ù‚Ø¯Ø§Ø±
document.getElementById('nowpay-btn').addEventListener('click', async (e)=>{
  e.preventDefault();
  const name = document.getElementById('name').value;
  const phone = document.getElementById('phone').value;
  const amount = parseFloat(document.getElementById('amount').value) || 0;
  if(amount<=0){alert('Ù…Ø¨Ù„Øº Ù…Ø¹ØªØ¨Ø± Ù†ÛŒØ³Øª'); return;}
  
  // Ù†Ù…Ø§ÛŒØ´ popup
  showDonation(name, phone, amount);

  // Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ù„ÛŒÙ†Ú© NowPayments Ø¨Ø§ api key
  window.open('https://nowpayments.io/donation?api_key=MP94SK3-2RNMDJ4-PPKQWSS-GHCVMNJ','_blank');
});
</script>

</body>
</html>
