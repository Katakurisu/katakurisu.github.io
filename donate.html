<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>دونیت – میلاد کاتاکوری</title>
<style>
    body { font-family: Tahoma, sans-serif; background: #f8f8f8; display: flex; justify-content: center; padding: 20px; }
    .donate-box { background: #fff; padding: 25px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); width: 100%; max-width: 400px; }
    h2 { text-align: center; margin-bottom: 20px; }
    input { width: 100%; padding: 12px; margin-bottom: 15px; border-radius: 6px; border: 1px solid #ccc; font-size: 1rem; }
    #usdtDisplay { font-weight: bold; margin-bottom: 15px; text-align: center; }
    .donate-btn { width: 100%; background: #fff; border: 1px solid #ccc; padding: 12px; border-radius: 6px; cursor: pointer; font-weight: bold; font-size: 1rem; display: flex; align-items: center; justify-content: center; }
    .donate-btn img { margin-left: 10px; height: 24px; }
</style>
</head>
<body>

<div class="donate-box">
    <h2>حمایت از میلاد کاتاکوری</h2>
    <input type="text" id="name" placeholder="نام (اختیاری)">
    <input type="text" id="phone" placeholder="شماره تماس (اختیاری)">
    <input type="number" id="tomanInput" placeholder="مبلغ به تومان" min="1">
    <div id="usdtDisplay">۰ تومان = ۰ USDT</div>
    <a id="donateLink" href="#" target="_blank" class="donate-btn">
        <img src="https://nowpayments.io/images/embeds/donation-button-white.svg" alt="NowPayments">
        پرداخت
    </a>
</div>

<script>
let usdtRate = 0;
let donationAmountToman = 0;

async function fetchUSDT() {
    try {
        const res = await fetch('https://api.nobitex.ir/v2/orderbook/?market=usdt-irt');
        const data = await res.json();
        usdtRate = parseFloat(data.ticker.last);
        updateUSDTDisplay();
    } catch(e) {
        console.error('خطا در دریافت نرخ تتر:', e);
    }
}

function updateUSDTDisplay() {
    const usdtAmount = usdtRate ? (donationAmountToman / usdtRate).toFixed(2) : 0;
    document.getElementById('usdtDisplay').textContent = `${donationAmountToman.toLocaleString()} تومان = ${usdtAmount} USDT`;
    document.getElementById('donateLink').href = `https://nowpayments.io/donation?api_key=MP94SK3-2RNMDJ4-PPKQWSS-GHCVMNJ&amount=${usdtAmount}`;
}

document.getElementById('tomanInput').addEventListener('input', e => {
    donationAmountToman = parseFloat(e.target.value) || 0;
    updateUSDTDisplay();
});

setInterval(fetchUSDT, 30000);
fetchUSDT();
</script>

</body>
</html>
