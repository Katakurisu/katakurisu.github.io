<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ Ø­Ù…Ø§ÛŒØª Ø§Ø² Ù…ÛŒÙ„Ø§Ø¯ Ú©Ø§ØªØ§Ú©ÙˆØ±ÛŒ</title>
<link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;600&display=swap" rel="stylesheet">
<style>
body {
  margin:0;
  font-family:'Vazirmatn',sans-serif;
  background:#000;
  color:#00ff99;
  text-align:center;
  direction:rtl;
  overflow-x:hidden;
}
h1 {
  margin:50px 0;
  font-size:2.2em;
  text-shadow:0 0 15px #00ff99;
}
form {
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:15px;
  margin-bottom:50px;
}
input, button {
  padding:12px 18px;
  font-size:1.1em;
  border-radius:8px;
  border:1px solid #00ff99;
  background:transparent;
  color:#00ff99;
}
input:focus {outline:none; border:1px solid #0f0;}
button {cursor:pointer;}
#overlay {
  position:fixed; inset:0; pointer-events:none;
}
#donation-alert {
  position:absolute; top:40%; left:50%;
  transform:translate(-50%,-50%);
  text-align:center;
  background:rgba(0,0,0,0.9);
  border:1px solid #00ff99;
  border-radius:20px;
  padding:20px 30px;
  display:none;
  z-index:10;
}
#donation-video {width:200px; height:200px; border-radius:12px; margin-bottom:10px;}
#donor-text {font-size:1.2em; text-shadow:0 0 10px #00ff99;}
#stats {
  position:fixed; bottom:8%; left:50%;
  transform:translateX(-50%);
  font-size:1.2em;
  background:rgba(0,0,0,0.85);
  border-radius:14px;
  padding:15px 25px;
  color:#00ff99;
  text-shadow:0 0 12px #00ff99;
  line-height:1.6;
  z-index:5;
}
</style>
</head>
<body>

<h1>ğŸ Ø­Ù…Ø§ÛŒØª Ø§Ø² Ù…ÛŒÙ„Ø§Ø¯ Ú©Ø§ØªØ§Ú©ÙˆØ±ÛŒ</h1>

<form id="donation-form">
  <input type="text" id="donor-name" placeholder="Ù†Ø§Ù… (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)">
  <input type="tel" id="donor-phone" placeholder="Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³ (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)">
  <input type="number" id="donation-amount" placeholder="Ù…Ø¨Ù„Øº Ø¨Ù‡ ØªÙˆÙ…Ø§Ù†" step="1000" min="1000">
  <p id="converted">0 ØªÙˆÙ…Ø§Ù† = 0.00 USDT</p>
  <button type="submit">Ù¾Ø±Ø¯Ø§Ø®Øª Ø¨Ø§ NowPayments</button>
</form>

<div id="overlay">
  <div id="donation-alert">
    <video id="donation-video" src="donate.mp4" autoplay muted></video>
    <p id="donor-text"></p>
  </div>
  <div id="stats">
    <p>ğŸ’° Ø¬Ù…Ø¹ Ú©Ù„: <span id="total">0</span> ØªÙˆÙ…Ø§Ù†</p>
    <p>ğŸ¯ Ø¯Ø±ØµØ¯ Ù‡Ø¯Ù: <span id="percent">0</span>%</p>
  </div>
</div>

<script>
const totalEl = document.getElementById('total');
const percentEl = document.getElementById('percent');
const alertBox = document.getElementById('donation-alert');
const donorText = document.getElementById('donor-text');
const videoEl = document.getElementById('donation-video');
const converted = document.getElementById('converted');
let total = 0, target = 60000000;

// Ù†Ø±Ø® ØªØ¨Ø¯ÛŒÙ„ ØªÙˆÙ…Ø§Ù† Ø¨Ù‡ USDT Ø²Ù†Ø¯Ù‡ Ø§Ø² Nobitex (Ù…Ø«Ø§Ù„)
async function getUSDTPrice() {
  try {
    const res = await fetch('https://api.nobitex.ir/market/tether/toman');
    const data = await res.json();
    return parseFloat(data.last_price); // Ù‚ÛŒÙ…Øª Ù‡Ø± USDT Ø¨Ù‡ ØªÙˆÙ…Ø§Ù†
  } catch(e) { console.warn(e); return 50000; }
}

// Ø¢Ù¾Ø¯ÛŒØª Ù…Ø¹Ø§Ø¯Ù„ USDT Ù‡Ù†Ú¯Ø§Ù… ÙˆØ±ÙˆØ¯ Ù…Ø¨Ù„Øº
document.getElementById('donation-amount').addEventListener('input', async e=>{
  const price = await getUSDTPrice();
  const amount = parseFloat(e.target.value) || 0;
  const usdt = (amount/price).toFixed(2);
  converted.textContent = `${amount.toLocaleString('fa-IR')} ØªÙˆÙ…Ø§Ù† = ${usdt} USDT`;
});

// Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ NowPayments
document.getElementById('donation-form').addEventListener('submit', async e=>{
  e.preventDefault();
  const name = document.getElementById('donor-name').value || 'Ø­Ø§Ù…ÛŒ Ù†Ø§Ø´Ù†Ø§Ø³';
  const phone = document.getElementById('donor-phone').value || '';
  const amountToman = parseFloat(document.getElementById('donation-amount').value);
  if(!amountToman) return alert('Ù„Ø·ÙØ§ Ù…Ø¨Ù„Øº Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');

  const price = await getUSDTPrice();
  const usdtAmount = (amountToman/price).toFixed(2);

  // Ù†Ù…Ø§ÛŒØ´ popup Ø¯ÙˆÙ†ÛŒØª
  donorText.textContent = `${name} | ${amountToman.toLocaleString('fa-IR')} ØªÙˆÙ…Ø§Ù† = ${usdtAmount} USDT`;
  alertBox.style.display='block';
  videoEl.currentTime=0;
  videoEl.play();
  setTimeout(()=>{alertBox.style.display='none';},13000);

  // Ø¢Ù¾Ø¯ÛŒØª Ø¬Ù…Ø¹ Ú©Ù„
  total += amountToman;
  totalEl.textContent = total.toLocaleString('fa-IR');
  percentEl.textContent = Math.min(((total/target)*100).toFixed(1),100);

  // Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ù„ÛŒÙ†Ú© NowPayments
  const apiKey = 'MP94SK3-2RNMDJ4-PPKQWSS-GHCVMNJ';
  const donationUrl = `https://nowpayments.io/donation?api_key=${apiKey}&price_amount=${usdtAmount}&price_currency=usdt&order_description=Donation`;
  window.open(donationUrl,'_blank');
});
</script>

</body>
</html>
