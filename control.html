<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Goal Control Dashboard</title>
<style>
body {
  margin:0;
  font-family:'Vazirmatn',sans-serif;
  background:#111;
  color:#00ff99;
  direction:rtl;
  padding:20px;
}
h1 { text-align:center; color:#ff5555; }
label { display:block; margin-top:15px; }
input { padding:5px; font-size:1em; width:100%; margin-top:5px; }
button { margin-top:10px; padding:8px 15px; font-size:1em; cursor:pointer; }
#goal-display {
  margin-top:30px;
  border:2px solid yellow;
  padding:15px;
  border-radius:10px;
}
</style>
</head>
<body>

<h1>Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ù‡Ø¯Ù</h1>

<label>Ø¹Ù†ÙˆØ§Ù† Ù‡Ø¯Ù:</label>
<input type="text" id="goal-title-input">

<label>Ù…Ø¨Ù„Øº Ù‡Ø¯Ù (ØªÙˆÙ…Ø§Ù†):</label>
<input type="number" id="goal-amount-input">

<label>Ù…Ø¨Ù„Øº ÙØ¹Ù„ÛŒ Ø­Ù…Ø§ÛŒØª Ø´Ø¯Ù‡ (ØªÙˆÙ…Ø§Ù†):</label>
<input type="number" id="current-amount-input">

<button id="update-goal-btn">Ø¨Ù‡â€ŒØ±ÙˆØ² Ø±Ø³Ø§Ù†ÛŒ Ù‡Ø¯Ù</button>
<button id="add-donation-btn">Ø§ÙØ²ÙˆØ¯Ù† Ø­Ù…Ø§ÛŒØª Ø¬Ø¯ÛŒØ¯</button>

<div id="goal-display">
  <h2>Ù†Ù…Ø§ÛŒØ´ Ø²Ù†Ø¯Ù‡ Ù‡Ø¯Ù:</h2>
  <p id="goal-display-title"></p>
  <p id="goal-display-bar"></p>
  <p id="goal-display-text"></p>
</div>

<script>
const bc = new BroadcastChannel('goal_channel');

const goalTitleInput = document.getElementById('goal-title-input');
const goalAmountInput = document.getElementById('goal-amount-input');
const currentAmountInput = document.getElementById('current-amount-input');
const updateBtn = document.getElementById('update-goal-btn');
const addDonationBtn = document.getElementById('add-donation-btn');

const displayTitle = document.getElementById('goal-display-title');
const displayBar = document.getElementById('goal-display-bar');
const displayText = document.getElementById('goal-display-text');

// Ù…Ù‚Ø§Ø¯ÛŒØ± Ø§ÙˆÙ„ÛŒÙ‡
let goalTitle = 'Ø®Ø±ÛŒØ¯ ÙˆØ¨Ú©Ù…';
let goalAmount = 6000000;
let currentAmount = 0;

// Ø¢Ù¾Ø¯ÛŒØª Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø®Ù„ Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯
function updateDisplay() {
  const percentage = Math.min((currentAmount / goalAmount) * 100, 100);
  displayTitle.innerHTML = `ğŸ Ù‡Ø¯Ù: ${goalTitle}`;
  displayBar.innerHTML = `Ù†ÙˆØ§Ø±: ${percentage.toFixed(0)}%`;
  displayText.innerHTML = `ØªØ§Ú©Ù†ÙˆÙ† ${currentAmount.toLocaleString('fa-IR')} Ø§Ø² ${goalAmount.toLocaleString('fa-IR')} ØªÙˆÙ…Ø§Ù† Ø­Ù…Ø§ÛŒØª Ø´Ø¯Ù‡`;
}

// Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ OBS
function broadcast() {
  bc.postMessage({goalTitle, goalAmount, currentAmount});
}

// Ø¯Ú©Ù…Ù‡ Ø¨Ù‡â€ŒØ±ÙˆØ² Ø±Ø³Ø§Ù†ÛŒ Ù‡Ø¯Ù
updateBtn.onclick = () => {
  goalTitle = goalTitleInput.value || goalTitle;
  goalAmount = parseInt(goalAmountInput.value) || goalAmount;
  currentAmount = parseInt(currentAmountInput.value) || currentAmount;
  updateDisplay();
  broadcast();
};

// Ø§ÙØ²ÙˆØ¯Ù† Ø­Ù…Ø§ÛŒØª Ø¬Ø¯ÛŒØ¯
addDonationBtn.onclick = () => {
  const donation = parseInt(currentAmountInput.value) || 0;
  currentAmount += donation;
  updateDisplay();
  broadcast();
};

// Ø¢Ù¾Ø¯ÛŒØª Ø§ÙˆÙ„ÛŒÙ‡
goalTitleInput.value = goalTitle;
goalAmountInput.value = goalAmount;
currentAmountInput.value = currentAmount;
updateDisplay();
broadcast();
</script>

</body>
</html>
