<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Goal Overlay - OBS</title>
<style>
body {
  margin:0;
  font-family:'Vazirmatn',sans-serif;
  background:transparent; /* شفاف برای OBS */
  direction:rtl;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}

#goal-container {
  width:20%; /* طول کلی نوار */
  min-width:200px;
  display:flex;
  flex-direction:column;
  align-items:flex-end; /* راست‌چین کردن محتوا */
}

#goal-title {
  font-size:1.5em;
  color:red;
  text-shadow:0 0 5px #000;
  margin-bottom:5px;
  display:flex;
  align-items:center;
  gap:5px;
}

#goal-title img {
  width:24px;
  height:24px;
}

#goal-bar-wrapper {
  width:100%;
  height:30px;
  border:3px solid yellow; /* بوردر دور نوار */
  border-radius:8px;
  background:transparent; /* شفاف */
  position:relative;
  overflow:hidden;
}

#goal-bar-fill {
  height:100%;
  width:0%;
  background:#00ff99; /* سبز فسفری */
  text-align:left;
  line-height:30px;
  padding-left:5px;
  box-sizing:border-box;
  color:#000;
  font-weight:bold;
}

#goal-bar-fill span {
  direction:ltr;
  float:left; /* درصد سمت چپ */
  margin-left:5px;
}

#goal-text-bottom {
  margin-top:5px;
  font-size:1.2em;
  color:#00ff99;
  text-align:right; /* راست‌چین */
  text-shadow:0 0 5px #000;
}
</style>
</head>
<body>

<div id="goal-container">
  <div id="goal-title">
    <img src="https://cdn-icons-png.flaticon.com/512/889/889692.png" alt="کادو">
    هدف: خرید وبکم
  </div>

  <div id="goal-bar-wrapper">
    <div id="goal-bar-fill">
      <span id="goal-percentage">0%</span>
    </div>
  </div>

  <div id="goal-text-bottom">
    تاکنون 0 از 6,000,000 تومان حمایت شده
  </div>
</div>

<script>
const goalBarFill = document.getElementById('goal-bar-fill');
const goalPercentage = document.getElementById('goal-percentage');
const goalTextBottom = document.getElementById('goal-text-bottom');
const goalTitleElement = document.getElementById('goal-title');

// گرفتن مقادیر از localStorage
let currentAmount = parseInt(localStorage.getItem('currentAmount')) || 0;
let goalAmount = parseInt(localStorage.getItem('goalAmount')) || 6000000;
let goalTitle = localStorage.getItem('goalTitle') || 'خرید وبکم';

// به‌روزرسانی نوار هدف
function updateGoalBar() {
  let percentage = Math.min((currentAmount / goalAmount)*100,100);
  goalBarFill.style.width = percentage + '%';
  goalPercentage.textContent = percentage.toFixed(0) + '%';
  goalTextBottom.textContent = `تاکنون ${currentAmount.toLocaleString()} از ${goalAmount.toLocaleString()} تومان حمایت شده`;
  goalTitleElement.innerHTML = `<img src="https://cdn-icons-png.flaticon.com/512/889/889692.png" alt="کادو"> هدف: ${goalTitle}`;
}

// تابع برای بروزرسانی مقادیر از داشبورد
function updateGoalValues(newCurrent, newGoal, newTitle) {
  currentAmount = newCurrent;
  goalAmount = newGoal;
  goalTitle = newTitle;
  localStorage.setItem('currentAmount', currentAmount);
  localStorage.setItem('goalAmount', goalAmount);
  localStorage.setItem('goalTitle', goalTitle);
  updateGoalBar();
}

// بروزرسانی بار اول
updateGoalBar();
</script>

</body>
</html>
