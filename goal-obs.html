<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ¯ Ù†ÙˆØ§Ø± Ù‡Ø¯Ù</title>
<style>
body {
  margin:0;
  font-family:'Vazirmatn',sans-serif;
  background:transparent;
  color:#00ff99;
  text-align:center;
  direction:rtl;
  overflow:hidden;
}

/* -------------------- ğŸ¯ Ø¨Ø®Ø´ Ù‡Ø¯Ù -------------------- */
#goal-container {
  position:fixed;
  top:10%;
  left:50%;
  transform:translateX(-50%);
  width:80%;
  max-width:600px;
  background:rgba(0,0,0,0.6);
  border-radius:20px;
  padding:15px;
  box-shadow:0 0 15px #00ff99;
}

#goal-title {
  font-size:1.4em;
  margin-bottom:10px;
}

#goal-bar-bg {
  width:100%;
  height:30px;
  background:#111;
  border-radius:15px;
  overflow:hidden;
}

#goal-bar-fill {
  width:0%;
  height:100%;
  background:#00ff99;
  border-radius:15px 0 0 15px;
  transition:width 1s ease;
}

#goal-text {
  margin-top:8px;
  font-size:1em;
}
</style>
</head>
<body>

<div id="goal-container">
  <div id="goal-title">ğŸ¯ Ù‡Ø¯Ù: Ø®Ø±ÛŒØ¯ ÙˆØ¨Ú©Ù…</div>
  <div id="goal-bar-bg">
    <div id="goal-bar-fill"></div>
  </div>
  <div id="goal-text">Ø¬Ù…Ø¹ Ú©Ù„: 0 Ø±ÛŒØ§Ù„ | 0%</div>
</div>

<script>
let total = 0;
const target = 60000000; // Ù…Ø¨Ù„Øº Ù‡Ø¯Ù
const goalFill = document.getElementById('goal-bar-fill');
const goalText = document.getElementById('goal-text');

// -------------------- ğŸŒ Ø§ØªØµØ§Ù„ ÙˆØ¨Ù‡ÙˆÚ© --------------------
async function fetchDonations() {
  try {
    const res = await fetch('https://eoyf8grpms15wjd.m.pipedream.net', { cache: 'no-store' });
    const data = await res.json();
    data.forEach(d => {
      if(!d.handled){
        d.handled = true;
        updateGoal(d);
      }
    });
  } catch(e) { console.warn(e); }
}

setInterval(fetchDonations, 5000);

// -------------------- ğŸ¬ Ø¢Ù¾Ø¯ÛŒØª Ù†ÙˆØ§Ø± Ù‡Ø¯Ù --------------------
function updateGoal(d){
  const amountIRR = d.amount*d.currency_rate || d.amount || 0;
  total += amountIRR;
  const percent = Math.min((total/target)*100, 100);
  
  goalFill.style.width = percent+'%';
  goalText.textContent = `Ø¬Ù…Ø¹ Ú©Ù„: ${total.toLocaleString('fa-IR')} Ø±ÛŒØ§Ù„ | ${percent.toFixed(1)}%`;
}
</script>

</body>
</html>
