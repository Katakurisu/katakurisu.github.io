<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>هدف حمایت – میلاد کاتاکوری</title>
<style>
    body { font-family: Tahoma, sans-serif; background: #f8f8f8; display: flex; justify-content: center; padding: 20px; }
    .goal-box { background: #fff; padding: 25px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); width: 100%; max-width: 400px; text-align: center; }
    h2 { margin-bottom: 20px; }
    .progress-container { background: #e0e0e0; border-radius: 12px; overflow: hidden; height: 30px; margin: 20px 0; }
    .progress-bar { height: 100%; background: #4caf50; width: 0%; transition: width 0.5s; }
    #totalDisplay { font-weight: bold; font-size: 1.2rem; }
</style>
</head>
<body>

<div class="goal-box">
    <h2>پیشرفت هدف حمایت</h2>
    <div id="totalDisplay">۰ تومان = ۰ USDT</div>
    <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
    </div>
    <div id="goalText"></div>
</div>

<script>
let usdtRate = 0;
let totalToman = 0;
const goalToman = 1000000; // مثال هدف 1,000,000 تومان

async function fetchUSDT() {
    try {
        const res = await fetch('https://api.nobitex.ir/v2/orderbook/?market=usdt-irt');
        const data = await res.json();
        usdtRate = parseFloat(data.ticker.last);
        updateGoalDisplay();
    } catch(e) {
        console.error('خطا در دریافت نرخ تتر:', e);
    }
}

// این متغیر برای مثال هست، بعداً می‌تونی از پایگاه داده واقعی بگیری
function fetchTotalDonations() {
    // مثال: مجموع حمایت‌ها
    totalToman = 666000; // این مقدار را واقعی کنید
}

function updateGoalDisplay() {
    const usdtAmount = usdtRate ? (totalToman / usdtRate).toFixed(2) : 0;
    document.getElementById('totalDisplay').textContent = `${totalToman.toLocaleString()} تومان = ${usdtAmount} USDT`;

    const progressPercent = Math.min((totalToman / goalToman) * 100, 100);
    document.getElementById('progressBar').style.width = progressPercent + '%';
    document.getElementById('goalText').textContent = `پیشرفت: ${progressPercent.toFixed(2)}% از هدف`;
}

fetchTotalDonations();
setInterval(fetchUSDT, 30000);
fetchUSDT();
</script>

</body>
</html>
